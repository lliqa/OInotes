## CDQ 分治

解决偏序问题或贡献有偏序关系时，若 $i$ 对 $j$ 造成贡献的必要条件有 $a_i < a_j$，可以先所有元素按 $a$ 升序排序，然后用 $O(\log n)$ 的代价进行分治，分治到区间 $[l, r]$ 时仅计算 $[l, mid]$ 中的元素对 $[mid + 1, r]$ 中元素的贡献。  
显然每对**可能**有贡献的元素组 $(i, j)$（$a_i < a_j)$ 一定**会且仅会**被计算一次，即只存在唯一的分治区间 $[l, r]$ 使得 $l \leq i \leq mid < j \leq r$（证明考虑自上而下分治的过程，追踪 $(i, j)$ 的位置）。  
这样分治相当于将 $a$ 维全变成了 $0/1$，约等于降了一维。如果不止一维，可以继续嵌套 CDQ 分治，直到剩下两维，一般采用一维归并一维数据结构的维护方法。