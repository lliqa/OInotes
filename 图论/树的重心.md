[TOC]

### 定义

重心：树上某点（可能有多个），满足最大的子树大小最小。
带权重心：一颗树，每个点有点权（点权均为正）。带权重心为树上某点（可能有多个），满足最大的子树权和最小。  
重心就是是点权均相同时的带权重心。

### 性质

> 点为重心 $\iff$ 所有子树大小 $\leq \lfloor \dfrac{n}{2} \rfloor$。

证明：

充分性：
反证法。  
假设存在点 $p$ 为重心，满足其某一子树大小 $> \lfloor \dfrac{n}{2} \rfloor$。  
首先肯定只会有一个子树满足此条件，记该子树树根为 $q$。  
发现 $q$ 最大的子树大小严格小于 $p$ 最大的子树大小，因此 $p$ 不是重心。假设不成立，原命题得证。

必要性：
反证法。  
假设存在满足所有子树大小 $\leq \lfloor \dfrac{n}{2} \rfloor$ 的点 $p$ 不为重心，在点 $p$ 以 $q$ 为根的子树中点 $u$ 为重心。  
首先有 $siz(q) \leq \lfloor \dfrac{n}{2} \rfloor \implies n - siz (q) \geq \lceil \dfrac{n}{2} \rceil$。  
$u$ 一定存在一个子树大小 $\geq n - siz (q)$，即 $p$ 一定不劣于 $u$，如果 $u$ 是重心则 $p$ 一定也是重心，故 $u$ 一定不是重心。假设不成立，原命题得证。

> 一棵树最多两个重心，且一定相邻，将整棵树分成大小相同的两部分。

证明：

如果存在两个重心并且不相邻，那么两重心路径上点一定严格更优。因为该点的任意子树，都会被两重心之一的某一子树完全包含。因此若存在两个重心，一定相邻。

假设存在 $> 2$ 个重心，由上分析扩展得它们一定两两相邻。而树上显然不存在 $>2$ 得两两相邻点集。因此一棵树最多有两个重心。

若存在两个重心，不难发现一定将树分成大小相同的两部分，也即点数为奇数的树不可能存在两个重心。

> dfs 序上的带权中心一定在带权重心的子树中。

证明：

反证法。如果带权重心不为带权中心的祖先，那么一定存在一个子树大小 $> \lfloor \dfrac{n}{2} \rfloor$。具体来说，逐个分析每一部分：dfs 在中心前面或后面的，内部细分一下。