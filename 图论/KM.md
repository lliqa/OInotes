[TOC]

### 简介

一种求解二分图最大权完美匹配的算法，时间复杂度 $O(n^3)$。

### 原理

为所有点维护一个顶标，左部 $i$ 的顶标为 $lx (i)$，右部 $j$ 的顶标为 $ly (j)$，满足 $lx (i) + ly (j) \geq e (i, j)$。

定义相等子图为只包含满足 $lx (i) + ly (j) = e(i, j)$ 的边的子图。  
如果相等子图存在完美匹配，那么该匹配一定同时权最大。  
证明：对于任意完美匹配 $M$，$\sum_{(x, y) \in M} e (x, y) \leq \sum_{i}lx (i) + \sum_{j} ly (j)$，而相等子图中的完美匹配能取到上界，一定最大。

该算法通过不断调整顶标，使得相等子图存在完美匹配。

### 流程

首先初始化顶标，$lx (i) = \max \{e (i, j)\}, ly (j) = 0$。  
依次遍历左部点 $x$，尝试在当前相等子图中寻找增广路。如果无法增广，需要调整顶标，新增一条未访问过的右部点与访问过的左部点的边，从而继续增广。具体地，记左部已访问集合为 $S$，未访问集合为 $S'$，右部分别为 $T$ 和 $T'$。对右部点 $j$ 维护 $slack (j) = \min_{i \in S} \{ lx (i) + ly (j) -e (i, j)\}$，调整顶标的量 $\Delta = \min_{j \in T'} \{ slack (j) \}$，$S$ 集合 $-\Delta$, $T$ 集合 $+\Delta$，这样不会影响已匹配的边，并且能达到新增边 $(x \in S, y \in T')$ 的要求。

### 实现

采用 BFS 迭代实现。