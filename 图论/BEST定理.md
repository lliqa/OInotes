# BEST Theorem 笔记

> 目录  
> 1. 前置概念与性质
> 2. 定理内容
> 3. 证明
> 4. 后记

</br>
</br>
</br>

## 1. 前置概念与性质

### 概念

* 欧拉回路：在有向图中一个点出发经过所有边 $1$ 次并回到起点的路径。
* 欧拉图：存在欧拉回路的有向图。

</br>

### 性质

> 在欧拉图中每个点出度与入度相等。

证明：  
对于起点，为满足**回路**的性质，每次出去必须要回来，故每有一条出边必有一条对应入边。  
对于非起点，每次进入该点时必须要出去，否则回不到起点，故每有一条入边必有一条对应出边。  
综上可知该性质成立。

</br>
</br>
</br>

## 2. 定理内容

在欧拉图 $G$ 中，欧拉回路的个数为：

$$
t^{root}(G,k)\prod_{v\in V}(\deg (v) - 1)!
$$

其中 $t^{root}(G,k)$ 为以 $k$ 为根的根向生成树个数，$\deg (v)$ 为 $v$ 点的度数。  
如果要求以点 $i$ 开始的欧拉回路个数且边序列不同算不同，还须乘上一个 $\deg (i)$。

</br>
</br>
</br>

## 3. 证明

方法：构造证明。

> $\operatorname{define}(1)$：对于一个根向生成树 $t$（假设根为 $1$），给每个点出发的非树边内部规定一个顺序 $o$。定义二元组 $(t, o)$ 为一个 **方案**。

</br>

> $\operatorname{lemma}(1)$：图 $G$ 中方案的个数为：

$$
t^{root}(G,1) \left(\prod_{v\in V}(\deg (v) - 1)! \right) \deg (1)
$$

</br>

现在需要证明方案与从 $1$ 出发且**经过边序列不同算不同**的欧拉回路（记作 $K$ 回路）一一对应。

> $\operatorname{lemma}(2)$：方案对应 $K$ 回路。

证明：

构造：从 $1$ 出发，按照方案中边分配的顺序遍历，优先走非树边最后走树边，这样一定能走出一条欧拉回路。  
回路证明：对于非 $1$ 号点，每次进去必有一条出边相对应（欧拉图的性质），故不可能成为终点，即起点与终点皆为 $1$。  
每条边都经过一次证明：假设点 $u$ 存在出边或入边未经过，则其树边必然未经过。同理 $\operatorname{fa}(u)$ 的树边也未经过。递归可得 $1$ 号点存在出边未经过。说明此时 $1$ 号点非回路终点，与 "回路" 性质矛盾。故假设不成立，每条边都经过一次。

> $\operatorname{lemma}(3)$：$K$ 回路对应方案。

证明：

等价于证明由 $K$ 回路确定的树边不会形成环。  
假设存在环，由于 $1$ 号点无树边，因此不可能在环上。  
考虑环上最先被遍历树边的点 $u$，经过 $u$ 点树边后仍能通过环上树边（未遍历）回到 $u$，与 "树边为最后一条出边" 相矛盾。故假设不成立，不会形成环。

</br>

根据 $\operatorname{lemma}(2)(3)$ 可得 $K$ 回路的个数为：

$$
t^{root}(G,1) \left(\prod_{v\in V}(\deg (v) - 1)! \right) \deg (1)
$$

由于欧拉回路循环同构算作同种方案，其个数为：

$$
t^{root}(G,1) \prod_{v\in V}(\deg (v) - 1)!
$$

## 4. 后记

写的很难受，自己都看不下去了……对不起……请谨慎参考。