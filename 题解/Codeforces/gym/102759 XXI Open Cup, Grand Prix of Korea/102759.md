[TOC]

### A. Advertisement Matching

首先可以建立一个简单的最大流模型：  
* 源点 $S$ 连所有广告供应商，容量为 $a_i$
* 顾客连汇点 $T$，容量为 $b_i$
* 广告供应商与顾客两两连边，容量为 $1$。

最大流等于 $\sum a_i$ 时满足要求。

考虑优化这一思路，最大流等于最小割，只要所有割权值均 $\geq \sum a_i$ 即可。本题中的网络流图是二分图，对于左部 $X$ 集合和右部 $Y$ 集合与源点联通的割，它的最小权值为：

$$
\sum_{i \not\in X} a_i + \sum_{i \in Y}b_i + |X|(m - |T|)
$$

将 $a_i$ 降序排序。
固定的 $|X| = k$，最小权值为：

$$
\sum_{i=k + 1}^n a_i + \sum_{i \in Y}b_i + \sum_{i \not\in Y}k = \sum_{i=k + 1}^n a_i + \sum_{i=1}^m \min \{b_i, k \}
$$

满足要求当且仅当：

$$
\sum_{i=k + 1}^n a_i + \sum_{i=1}^m \min \{b_i, k \} \geq \sum_{i=1}^n a_i \iff \sum_{i=1}^m \min \{b_i, k \} \geq \sum_{i=1}^k a_i
$$

对所有的 $k \in \{1, 2, \dots, n \}$ 成立。

$\sum_{i=1}^m \min \{b_i, k \} = \sum_{i=1}^k \sum_{j=1}^m [b_j \geq i]$，令 $c_i = \sum_{j=1}^m [b_j \geq i]$，要求转化为：

$$
\sum_{i=1}^k (c_i - a_i) \geq 0
$$

线段树维护前缀最小值。  
由于修改只会 $\pm 1$，对 $a_i$ 降序性和 $c$ 的影响位置是 $O(1)$ 的，单点修改即可。

### D. Just Meeting

题目限制为 $\forall i, j, k, C (i, j) \geq \min \{C (i, k), C (j, k)\}$。  

可以等价为： $C (i, j) \geq$ 所有 $i, j$ 之间简单路径上边权的最小值的最大值。  
对题目给出的边做最大生成树，存在解当且仅当所有给出的边 $(u, v, w)$，$w$ 等于生成树上 $u, v$ 之间路径的最小值。一个连通块中未确定的边，发现取下界是合法的，同时最优。连通块之间的边权赋 $1$ 即可。

### H. Alchemy

先特判只有一个数的情况，对 $1$ 取 $max$。

答案上界是 $O (n + \log siz)$。
二分答案 $k$，合法当且仅当能操作出一个局面，$0, \dots, k-1$ 均满足 $c>0$。  
考虑 check，$\geq k$ 的数都可以看作是 $0$，数 $x$ 可以由 $0, \dots x - 1$ 各一个拼出来，从大到小枚举数 $x$：  
* 如果 $c_x > 0$，那么贡献 $c_x - 1$ 个给 $c_0$；  
* 如果 $c_x < 0$，要用 $c_x + 1$ 份 $0, \dots x - 1$ 拼出 $c_x+1$ 个 $x$，维护当前 $[0, x-1]$ 每个数的需求量。

### J. Remote Control

对于一个询问 $(x, y)$，一种可能是始终不会撞墙，即操作序列前缀和不存在 $(-x, -y)$。另一种可能是在第 $k$ 次操作第一次撞墙，撤销第 $k$ 次操作，只会在 $(0, 0)$ 邻位，然后继续执行 $k+1$ 及后面的操作。  
预处理一个 $f (i, j)$，表示 $(0, 0)$ 的 $j$ 方向邻位，执行 $[i, n]$ 操作后到达的位置即可。

### K. Sewing Graph

最优化构造题。  
答案下界是 $2n-1$（恰好 $n-1$ 条实边和虚边）。  
题目限制边只能在端点处相交最多一次，比较离谱，但是可以简单地找到一条合法的链。  
考虑直接构造方案：设链为 $p_1, p_2, \dots, p_n$，构造方案 $p_1, p_2, \dots, p_n, p_n - 1, \dots p_1$。
把所有边看作在偶数位置连出在相邻位置，回文前半部分构造了所有大实边和小虚边，后半部分构造了小实边和大虚边。  
正确性得证，复杂度线性。
