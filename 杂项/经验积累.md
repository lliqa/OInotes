# 经验积累

### 树上异或差分

一类有关奇偶的问题，比如给边一个字符，问最长的路径满足将边上字符排列能够组成回文。

此题只与每个字母的出现次数奇偶有关，把每个字符看作二进制上的一位，假设对于一个 $26$ 位的二进制数 (字符集大小为 $26$ )，$i$ 位为 $1$ 表示出现次数为奇数，否则为偶数。

设
$$
\mathrm {dis} (i) = \mathrm{xor}_{j \in fa_i}{ \ val (j, fa_j)}
$$
发现 $\mathrm{dis} (i) \ \mathrm{xor} \ \mathrm{dis} (j)$ 即代表 $i - j$ 路径上每个字符的奇偶情况



### 区间询问

对于许多区间 $[l, r]$ 的询问，可以考虑固定右端点时每个左端点的贡献，然后考虑右端点移动时的贡献。

一类问题：求出权值最大的区间，定义权值为出现次数不超过 $1$ 的数的个数。

用线段树，考虑固定右端点 $r$，维护下标为左端点的权值最大区间。

对于数 $x$，设 $\mathrm{lst} (r, x)$ 为在 $r$ 右边且距离 $r$ 最近的 $x$ 的位置。

对于右端点 $r$ ，$x$ 能够贡献的左端点在 $[\mathrm{lst} (\mathrm{lst} (r, x), x) + 1, \mathrm{lst} (r, x)]$ 里面。用线段树维护区间加、查询最大值即可。

### 倍增跳前驱后继

适用于前驱后继唯一的题目，可使用倍增加速至 $O(\log n)$