### Prob 1.

维护原数组 $a$ 的差分数组 $b(b_i = a_i - a_{i-1})$，把区间求和差分为两个前缀和，考虑求 $\sum_{i=1}^k a_i$。

$$
\sum_{i=1}^k a_i = \sum_{i=1}^k \sum_{j=1}^i b_j = \sum_{i=1}^k b_i (k - i + 1) = k + k\sum_{i=1}^k b_i - \sum_{i=1}^k b_i \times i
$$

维护 $\sum b_i$ 和 $\sum b_i \times i$ 即可，至于区间加就是差分数组的两个单点加。

---

### Prob 2.

对每个 $a_i$ 开个链表，把二元组挂在 $a$ 的链表上，从小到大遍历每个链表，表内桶排序即可。

---

### Prob 3.

```cpp
int T = S;
while (T != 0) {
  claim a subset T of S.
  T = (T - 1) & S;
}
```

首先考虑 $S = 2^n-1$ 也就是 $S$ 形如 `1111111...` 的情况。此时 `(T-1)&S = T-1`，也就是 `T--` 直到 `T=0`。此时 $S$ 的非空子集也就是 $[1, S]$ 的所有整数，因此 $S = 2^n-1$ 时结论是对的。

再考虑其他情况，实际上可以类比上面的做法。这时 $S$ 形如 `10100100011000...` 这种。此时 `(T-1)&S` 手玩一下，发现相当于是一种特殊的 `T--`，也就是只关心 $S$ 中为 `1` 的位置。可以想象把 $S$ 中为 `1` 的位置提出来，看作是一个 $S' = 2^n - 1$ 的形式，沿用上面的思想，最后再插回去。`(T-1)&S` 即实现了对 $S'$ 的 `T--`。

综上，结论成立。

---

### Prob 4.

---

### Prob 5.

区间 $[l, r]$ 中 $1$ 的个数奇偶性相当于给出 $S_{l-1}$ 和 $S_r$ 的奇偶性异同。用带权并查集维护。

---

### Prob 6.

类似上题，相当于给出一堆 $S_r - S_{l-1} \equiv k_x \pmod n$，仍然使用带权并查集。

---

### Prob 7.

经典的 DSU on tree 做法。

---

### Prob 8.

---

### Prob 9.

---

### Prob 10.

二分答案，然后暴力枚举所有变量的大小关系进行 Check。复杂度 $O(n!\log v)$