## 分析

* 计数原理：构造若干便于计数的性质，计数分别满足这些性质的元素。
* 算重的原因：存在元素同时满足多个构造的性质。
* 防止算重的原理：构造恰当的性质使得不存在元素同时满足多个性质。

举例：  
代表元法：只在第一次满足某条件处统计贡献。“第一次满足条件的位置”即为构造的性质，一个元素不可能同时满足两个性质。

### 习题

* [[AGC019F] Yes or No](https://www.luogu.com.cn/problem/AT2705)

	> 首先转化为二维平面网格图问题. 有 $n$ 个 $Yes$ 与 $m$ 个 $No$ 等价于网格图上 $(n, m)$ 点. 目标是走到 $(0, 0)$ 点.
	>
	> 把答案序列看作是一条 $(n, m)$ 到 $(0, 0)$ 的折线. 最优策略当然是在 $n > m$ 时回答 $Yes$ , $n < m$ 时回答 $No$ . 至于 $n = m$ 时回答 $Yes/No$ 均可, 反正有 $\frac{1}{2}$ 的概率答对.
	>
	> 再把上述问题再次转化, 相当于在 $y = x$ 直线下方时统计答案序列向左走的次数, 在 $y = x$ 上方统计答案序列向下走的次数. 发现这样的次数总和恒为 $\max \left\{n, m\right\}$ . 但似乎少了点什么...在 $y = x$ 直线上呢? Easy, 统计经过 $y=x$ 的次数就行了.
	>
	> 根据期望的线性, 统计 $y = x$ 直线上每一点被经过的次数即可, 最后 $\times \frac{1}{2}$.
	
* [Bubble Sort](https://codeforces.com/gym/102222/problem/I)

	> 题意: 求 $n$ 个元素 $a_i$ 构成的所有排列中, 有多少个经过 $k$ 次冒泡排序之后, 基本有序. 基本有序指: 最长上升子序列的长度为 $n$ 或 $n−1$ .

	> 设 $F_i$ 表示下标在 $[1, i - 1]$ 中比 $a_i$ 大的数的个数.
	>
	> 手玩一下冒泡排序, 发现每一轮冒泡排序都会使得所有 $F_i$ 减一. 因为每一轮冒泡排序都会将最大值不断往前推, 第 $i$ 个位置的数恰好会和 $[1, i - 1]$ 中最大的数交换一次.
	>
	> 还有一个重要的性质, 排列与 $\left\{F_i\right\}$ 是一一对应的. 因为假设其长度为 $n$ , 那么 $F_n$ 能确定 $a_n$ 的排名, 继而确定 $a_{n-1}$ , 依此类推, 即可倒序确定唯一的 $a$ 数组. 同理可推知 $f_i + 1 \geq i$
	>
	> 于是问题转化为统计有多少个 $\left\{\max \left\{F_i-k, 0\right\}\right\}$ 对应着基本有序的序列.
	>
	> 基本有序的序列对应的 $\left\{F_i\right\}$ 长什么样呢?
	>
	> 1. 所有的 $F_i$ 均为 $0$ .
	> 2. 把已升序排列的序列中第 $i$ 个数插到 $j \ (j < i)$ 前, 使得 $F_x = 1 \ (x \in [j, i - 1])$
	> 3. 把已升序排列的序列中第 $i$ 个数插到 $j \ (j > i)$ 后, 使得 $F_i= j - i$
	>
	> 统计即可.

