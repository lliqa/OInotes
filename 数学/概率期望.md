### 1. 整数期望 (概率) 公式

$$
E(x)=\sum_{i=1}^{\infty}i \cdot P(x = i) = \sum_{i=1}^{\infty}P(x=i)\sum_{j=1}^i1 \\
=\sum_{j=1}^{\infty}\sum_{i=j}^{\infty}P(x=i) = \sum_{i=1}^{\infty}P(x \geq i)
$$

### 2. 习题选做

[洛谷P3600 随机数生成器]([P3600 随机数生成器 - 洛谷 | 计算机科学教育新生态 (luogu.com.cn)](https://www.luogu.com.cn/problem/P3600))

> 首先发现值域很小, 只有 $2 \times 10^3$ .
>
> 答案为 $\large{E(X)=\sum_{i=1}^x i \cdot P(X=i)}$ , 直接枚举 $i$ , 首要问题为计算 $P(X=i)$ .
>
> $P(X=i)$ 不怎么好算, 但 $P(X \leq i)$ 就好算多了.
>
> 差分一下可得 $\large{P(X=i)=P(X \leq i) - P(X \leq (i - 1))}$ . 接下来的问题是计算 $P(X \leq i)$.
>
> 把 $[1, x]$ 中 $\leq i$ 的数看作 $0$ , $ > i$ 的数看作 $1$ , 于是序列转化成了一个 $01$ 串, 问题在于计算有多少个 $01$ 串满足下面这个要求:
>
> 1. 每一个询问区间 $[l_i, r_i]$ 中**存在** $0$ .
>
> 考虑 DP , 设 $F(i, j)$ 表示考虑区间 $[1, j]$ 中放 $i$ 个 $0$, 且 $j$ 必放 $0$ , 使得所有 $l_k \leq j$ 的区间符合要求的方案数.
>
> 可以想到, 合法的转移位置一定是一段区间, 即
> $$
> F(i, j) = \sum_{k < j}^{j-1} F(i - 1, k)
> $$
> 如果存在询问区间 $[l, r]$ 使得 $k - 1 < l \leq k \leq r < j$ , 那么 $[k, j - 1]$ 即是对于 $j$ 合法的转移区间.
>
> 暴力 DP 是 $O(n^3)$ , 但是不难发现对于递增的 $j$, 其最远转移点 $k$ 也是递增的. 双指针乱杀即可 $O(n^2) .$

